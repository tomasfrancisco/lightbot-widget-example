(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(40);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},18:function(e,t,n){e.exports=n(54)},24:function(e,t,n){},26:function(e,t,n){},40:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withLightbotMessenger=function(e){return function(t){return function(n){function f(t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),n=function(e,t){if(t&&("object"===s(t)||"function"===typeof t))return t;return l(e)}(this,u(f).call(this,t)),g(l(l(n)),"updateHandler",function(){n.forceUpdate()}),g(l(l(n)),"toggleMessenger",function(){n.messenger.toggleMessenger()}),n.messenger=new a.LightbotMessenger(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){g(e,t,n[t])})}return e}({},e,{onChange:n.updateHandler})),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(f,n),function(e,t,n){t&&i(e.prototype,t);n&&i(e,n)}(f,[{key:"render",value:function(){return r.createElement(t,o({},this.props,{isMessengerOpen:this.messenger.isOpen,messages:this.messenger.messages,sendMessage:this.messenger.sendMessage,toggleMessenger:this.toggleMessenger}))}}]),f}(r.Component)}},Object.defineProperty(t,"LightbotMessage",{enumerable:!0,get:function(){return a.LightbotMessage}});var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}(n(41)),a=n(44);function s(e){return(s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45);Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})})},45:function(e,t,n){"use strict";var r=n(9);Object.defineProperty(t,"__esModule",{value:!0}),t.LightbotMessenger=void 0;var a,s=(a=n(48))&&a.__esModule?a:{default:a},o=n(51),i=n(53);function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){h(e,t,n[t])})}return e}function l(e,t,n,r,a,s,o){try{var i=e[s](o),u=i.value}catch(c){return void n(c)}i.done?t(u):Promise.resolve(u).then(r,a)}function g(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var s=e.apply(t,n);function o(e){l(s,r,a,o,i,"next",e)}function i(e){l(s,r,a,o,i,"throw",e)}o(void 0)})}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(){function e(t){var n=this,a=t.hostURL,l=t.agentId,f=t.onChange;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),h(this,"toggleMessenger",g(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stateManager.agent.isInitialized){e.next=6;break}return e.next=3,n.initMessenger();case 3:return t=e.sent,e.next=6,n.stateManager.updateAgent({isInitialized:t});case 6:n.stateManager.updateLayout({isMessengerOpen:!n.stateManager.layout.isMessengerOpen}),n.pushUpdate();case 8:case"end":return e.stop()}},e,this)}))),h(this,"sendMessage",function(){var e=g(r.mark(function e(t){var a,s;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stateManager.saveMessages([t],n.pushUpdate),e.prev=1,"jump"!==t.type){e.next=8;break}return e.next=5,n.apiClient.postJump(t.label);case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,n.apiClient.postMessage(t.label);case 10:a=e.sent;case 11:a&&(s=a.map(function(e){return c({},e,{sender:"bot"})}),n.stateManager.saveMessages(s,n.pushUpdate)),e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(1),n.stateManager.popMessage(n.pushUpdate),new Error("An error occurred sending a message.");case 18:case"end":return e.stop()}},e,this,[[1,14]])}));return function(t){return e.apply(this,arguments)}}()),h(this,"pushUpdate",function(){n.onChange&&setTimeout(n.onChange,0)}),h(this,"initMessenger",g(r.mark(function e(){var t,a,s;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.apiClient.postStartConversation();case 3:return(t=e.sent)&&(a=t.map(function(e){return c({},e,{sender:"bot"})}),n.stateManager.saveMessages(a,n.pushUpdate)),e.next=7,n.apiClient.getAgentData();case 7:return(s=e.sent)&&"object"===u(s)&&n.stateManager.updateAgent(s),e.abrupt("return",!0);case 12:e.prev=12,e.t0=e.catch(0),console.warn("An error occurred initializing messenger.");case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,this,[[0,12]])}))),this.stateManager=new i.StateManager,this.apiClient=new o.LightbotAPI(a,l,(0,s.default)(),(0,s.default)()),f&&(this.onChange=f)}var t,n,a;return t=e,(n=[{key:"isOpen",get:function(){return this.stateManager.layout.isMessengerOpen}},{key:"messages",get:function(){return this.stateManager.messages}}])&&f(t.prototype,n),a&&f(t,a),e}();t.LightbotMessenger=p},51:function(e,t,n){"use strict";var r=n(9);Object.defineProperty(t,"__esModule",{value:!0}),t.LightbotAPI=void 0;var a=n(52);function s(e,t,n,r,a,s,o){try{var i=e[s](o),u=i.value}catch(c){return void n(c)}i.done?t(u):Promise.resolve(u).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var o=e.apply(t,n);function i(e){s(o,r,a,i,u,"next",e)}function u(e){s(o,r,a,i,u,"throw",e)}i(void 0)})}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){function e(t,n,s,i){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"postStartConversation",o(r.mark(function e(){var t,n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.post("/start",{lightbot_agent_id:c.agentId,session_id:c.sessionId});case 3:return t=e.sent,e.next=6,t.json();case 6:if(!(n=e.sent)||!n.bot){e.next=9;break}return e.abrupt("return",n.bot);case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),new Error("An error occurred while starting conversation.");case 14:return e.abrupt("return",void 0);case 15:case"end":return e.stop()}},e,this,[[0,11]])}))),u(this,"post",function(){var e=o(r.mark(function e(t,n){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.fetch)("".concat(c.hostURL).concat(t),{body:JSON.stringify(n),headers:{"Content-Type":"application/json"},method:"POST"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()),this.hostURL=t,this.agentId=n,this.sessionId=s,this.userId=i}var t,n,s;return t=e,(n=[{key:"getAgentData",value:function(){var e=o(r.mark(function e(){var t,n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.get("/agent-data?lightbot_agent_id=".concat(this.agentId));case 3:return t=e.sent,e.next=6,t.json();case 6:if(!(n=e.sent)){e.next=9;break}return e.abrupt("return",n);case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),new Error("An error occurred while fetching agent data.");case 14:return e.abrupt("return",void 0);case 15:case"end":return e.stop()}},e,this,[[0,11]])}));return function(){return e.apply(this,arguments)}}()},{key:"postMessage",value:function(){var e=o(r.mark(function e(t){var n,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.post("",{human:t,lightbot_agent_id:this.agentId,session_id:this.sessionId,user_id:this.userId});case 3:return n=e.sent,e.next=6,n.json();case 6:if(!(a=e.sent)||!a.bot){e.next=9;break}return e.abrupt("return",a.bot);case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),new Error("An error occurred while sending a message.");case 14:return e.abrupt("return",void 0);case 15:case"end":return e.stop()}},e,this,[[0,11]])}));return function(t){return e.apply(this,arguments)}}()},{key:"postJump",value:function(){var e=o(r.mark(function e(t){var n,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.post("/jump",{jump:t,lightbot_agent_id:this.agentId,session_id:this.sessionId,user_id:this.userId});case 3:return n=e.sent,e.next=6,n.json();case 6:if(!(a=e.sent)||!a.bot){e.next=9;break}return e.abrupt("return",a.bot);case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),new Error("An error occured while sending a jump.");case 14:return e.abrupt("return",void 0);case 15:case"end":return e.stop()}},e,this,[[0,11]])}));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=o(r.mark(function e(t){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.fetch)("".concat(this.hostURL).concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}])&&i(t.prototype,n),s&&i(t,s),e}();t.LightbotAPI=c},53:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.StateManager=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"state",{agent:{isInitialized:!1},layout:{isMessengerOpen:!1},messages:[]}),this.initMessagesState(),this.initLayoutState(),this.initAgentState()}return a(e,null,[{key:"getKey",value:function(e){return'"19Hgw012xn!@"'.concat(e)}}]),a(e,[{key:"saveMessages",value:function(e,t){this.state.messages=this.state.messages.concat(e),this.updateMessagesStorage(),t&&t()}},{key:"popMessage",value:function(e){var t=this.state.messages.pop();return this.updateMessagesStorage(),e&&e(),t}},{key:"updateLayout",value:function(e){this.state.layout=Object.assign({},this.state.layout,e),this.updateLayoutStorage()}},{key:"updateAgent",value:function(e){this.state.agent=Object.assign({},this.state.agent,e),this.updateAgentStorage()}},{key:"initMessagesState",value:function(){if(this.testLocalStorage()){var t=localStorage.getItem(e.keys.messages);if(t)try{this.state.messages=this.deserialize(t)}catch(n){localStorage.setItem(e.keys.messages,this.serialize(this.state.messages)),console.warn("An error occurred while initalizing message storage. The message history was reset")}else localStorage.setItem(e.keys.messages,this.serialize(this.state.messages))}else console.warn("An error occurred while initalizing message storage. LocalStorage is not available")}},{key:"updateMessagesStorage",value:function(){if(this.testLocalStorage()){if(!localStorage.getItem(e.keys.messages))return localStorage.setItem(e.keys.messages,this.serialize(this.state.messages)),void console.warn("An error occurred while removing last message. The messages history was reset.");localStorage.setItem(e.keys.messages,this.serialize(this.state.messages))}}},{key:"initLayoutState",value:function(){if(this.testLocalStorage()){var t=localStorage.getItem(e.keys.layout);if(t)try{this.state.layout=this.deserialize(t)}catch(n){localStorage.setItem(e.keys.layout,this.serialize(this.state.layout)),console.warn("An error occurred while initalizing layout storage. The layout was reset.")}else localStorage.setItem(e.keys.layout,this.serialize(this.state.layout))}else console.warn("An error occurred while initalizing layout storage. LocalStorage is not available.")}},{key:"updateLayoutStorage",value:function(){this.testLocalStorage()&&(localStorage.getItem(e.keys.layout)||(localStorage.setItem(e.keys.layout,this.serialize(this.state.layout)),console.warn("An error occurred while removing last message. The layout was reset.")),localStorage.setItem(e.keys.layout,this.serialize(this.state.layout)))}},{key:"initAgentState",value:function(){if(this.testLocalStorage()){var t=localStorage.getItem(e.keys.agent);if(t)try{this.state.agent=this.deserialize(t)}catch(n){localStorage.setItem(e.keys.agent,this.serialize(this.state.agent)),console.warn("An error occurred while initalizing agent storage. The agent was reset")}else localStorage.setItem(e.keys.agent,this.serialize(this.state.agent))}else console.warn("An error occurred while initalizing agent storage. LocalStorage is not available.")}},{key:"updateAgentStorage",value:function(){if(this.testLocalStorage()){if(!localStorage.getItem(e.keys.agent))throw localStorage.setItem(e.keys.agent,this.serialize([])),new Error("An error occurred while updating agent. The agent was reset.");localStorage.setItem(e.keys.agent,this.serialize(this.state.agent))}}},{key:"testLocalStorage",value:function(){if(void 0!==this.state.isLocalStorageAvailable)return this.state.isLocalStorageAvailable;var e="localstorage_test_key";try{localStorage.setItem(e,"localstorage_test_value"),"localstorage_test_value"===localStorage.getItem(e)&&(localStorage.removeItem(e),this.state.isLocalStorageAvailable=!0)}catch(t){this.state.isLocalStorageAvailable=!1}return this.state.isLocalStorageAvailable}},{key:"serialize",value:function(e){return JSON.stringify(e)}},{key:"deserialize",value:function(e){return JSON.parse(e)}},{key:"messages",get:function(){return this.state.messages}},{key:"layout",get:function(){return this.state.layout}},{key:"agent",get:function(){return this.state.agent}}]),e}();t.StateManager=o,s(o,"keys",{agent:o.getKey("agent"),layout:o.getKey("layout"),messages:o.getKey("messages")})},54:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),s=n(2),o=n.n(s),i=(n(24),n(10)),u=n(11),c=n(16),l=n(12),g=n(17),f=(n(26),n(28),n(15)),h=n(14),p=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).transformMessages=function(e){return e.map(function(e){return{author:"bot"===e.sender?n.state.bot:n.state.user,text:e.label}})},n.addNewMessage=function(e){n.props.sendMessage({sender:"human",type:"plain",label:e.message.text})},n.countReplayLength=function(e){return"".concat(e," contains exactly ").concat(e?e.length:0," symbols.")},n.onToggle=function(){n.props.toggleMessenger()};return n.state={bot:{id:0},user:{id:1,avatarUrl:"https://via.placeholder.com/24/008000/008000.png"}},n}return Object(g.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.user,t=this.props,n=t.messages,r=t.isMessengerOpen;return a.a.createElement("div",null,a.a.createElement("button",{onClick:this.onToggle},r?"Close":"Open"),r&&a.a.createElement(f.a,{user:e,messages:this.transformMessages(n),onMessageSend:this.addNewMessage,placeholder:"Type a message...",width:400}))}}]),t}(r.Component),y=Object(h.withLightbotMessenger)({hostURL:"https://api.lightbot.io/v1/passthrough",agentId:"7a1eedf8-3afa-4281-b254-9f9d9bc97f6a"})(p);o.a.render(a.a.createElement(y,null),document.getElementById("root"))}},[[18,2,1]]]);
//# sourceMappingURL=main.a4e1206b.chunk.js.map